{"version":3,"file":null,"sources":["../src/index.js"],"sourcesContent":["import nodeToString from 'dom-node-tostring';\nimport isRegexp from 'is-regexp';\n\nfunction domSearch(doc, pattern, options){\n\n    const search = typeof options === 'object' ?  Object.create(options) : {};\n    search.all = typeof search.all === 'boolean' ? search.all : false;\n    search.type = getPatternType(pattern);\n    search.result = [];\n    search.pattern = pattern;\n\n    if(doc.nodeType === Node.ELEMENT_NODE){\n        return searchDoc(doc, search);\n    }else if(doc.nodeType === Node.TEXT_NODE){\n        if(doc.children.length){\n            return searchDoc(doc, search);\n        }else{\n            return checkTextNode(doc, search);\n        }\n    }\n\n}\n\nfunction searchDoc(doc, search){\n\n    searchChildren(doc, search);\n\n    return search.result;\n}\n\nfunction searchChildren(doc, search){\n    if(search.type === 'regexp'){\n        return searchRegexp(doc, search);\n    }\n\n    return searchString(doc, search);\n}\n\nfunction searchString(doc, search){\n\n    for(let i=0; i<doc.childNodes.length; i++){\n        let child = doc.childNodes[i];\n        \n        if(child.nodeType === Node.TEXT_NODE){\n            let str = nodeToString(child);\n\n            if(str.indexOf(search.pattern) !== -1){\n\n                search.result.push({\n                    textNode: child,\n                    parent: doc\n                });\n\n                if(!search.all){\n                    break;\n                }\n            }\n        }else{\n            searchDoc(child, search);\n        }\n    }\n\n    return search;\n}\n\nfunction searchRegexp(doc, search){\n\n    for(let i=0; i<doc.childNodes.length; i++){\n        let child = doc.childNodes[i];\n\n        if(child.nodeType === Node.TEXT_NODE){\n\n            let str = nodeToString(child);\n            let match;\n\n            if((match = str.match(search.pattern)) !== null){\n\n                search.result.push({\n                    textNode: child,\n                    parent: doc,\n                    match: match\n                });\n\n                if(!search.all){\n                    break;\n                }\n            }\n        }else{\n            searchDoc(child, search);\n        }\n    }\n\n    return search;\n}\n\nfunction checkTextNode(node, search){\n    let str = nodeToString(node);\n\n    if(search.type === 'string'){\n        if(doc.indexOf(pattern) !== -1){\n            return [{textNode: node, parent: node.parentNode}];\n        }\n    }else if(search.type === 'regexp'){\n        let match;\n        if(match = search.pattern.match(node)){\n            return [{\n                textNode: node,\n                parent: node.parentNode,\n                match: match\n            }];\n        }\n    }\n\n    return [];\n\n}\n\nfunction getPatternType(pattern){\n    if(isRegexp(pattern)){\n        return 'regexp';\n    }\n\n    return typeof pattern;\n}\n\nexport default domSearch;\n"],"names":[],"mappings":"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"}